<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Tonton Iklan</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      padding: 40px;
    }
    #lanjutBtn {
      display: none;
      margin-top: 20px;
      padding: 15px 30px;
      font-size: 18px;
      background-color: green;
      color: white;
      border: none;
      border-radius: 8px;
    }
  </style>
</head>
<body>

  <h2>Menonton Iklan...</h2>
  <iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ?autoplay=1" width="100%" height="300"></iframe>

  <button id="lanjutBtn" onclick="lanjut()">✅ Selamat Menonton</button>

  <script>
    // Simpan deviceId dan username dari URL
    const query = new URLSearchParams(window.location.search);
    const deviceId = query.get("deviceId") || "UNKNOWN";
    const username = query.get("username") || "usergratis";

    // Tampilkan tombol setelah 5 detik
    setTimeout(() => {
      document.getElementById("lanjutBtn").style.display = "inline-block";
    }, 5000);

    function lanjut() {
      const url = `https://script.google.com/macros/s/AKfycbznOW2N3qZI9uURT3kDxzL6KLoHVoJfvGyyf4nipkB0orvbEZ7Rcxe4qx_6g5GL0JLWWA/exec?free=true&deviceId=${deviceId}&username=${username}&source=login&adsok=true`;

      fetch(url)
        .then(res => res.json())
        .then(data => {
          if (data.success) {
            // Login sukses → lanjut ke app
            window.location.href = `mksport://lanjut?adsok=true`;
          } else {
            alert("Gagal: " + data.message);
          }
        })
        .catch(err => {
          alert("Gagal koneksi: " + err.message);
        });
    }
  </script>

</body>
</html>
